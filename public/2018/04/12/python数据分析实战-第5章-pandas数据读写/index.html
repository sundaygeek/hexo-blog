<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222">






  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



















  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.1.0" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.1.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.1.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.1.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.1.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '6.1.0',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="第5章　pandas：数据读写　　915.1　I/O API 工具　　915.2　CSV和文本文件　　925.3　读取CSV或文本文件中的数据　　921from pandas import * myCSV_01.csvwhite,red,blue,green,animal1,5,2,3,cat2,7,8,5,dog3,3,6,7,horse2,2,8,3,duck4,4,2,1,mouse 12c">
<meta name="keywords" content="python,pandas,数据分析">
<meta property="og:type" content="article">
<meta property="og:title" content="python数据分析实战-第5章-pandas数据读写">
<meta property="og:url" content="http://yoursite.com/2018/04/12/python数据分析实战-第5章-pandas数据读写/index.html">
<meta property="og:site_name" content="sun-day-blog">
<meta property="og:description" content="第5章　pandas：数据读写　　915.1　I/O API 工具　　915.2　CSV和文本文件　　925.3　读取CSV或文本文件中的数据　　921from pandas import * myCSV_01.csvwhite,red,blue,green,animal1,5,2,3,cat2,7,8,5,dog3,3,6,7,horse2,2,8,3,duck4,4,2,1,mouse 12c">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="http://yoursite.com/2018/04/12/python数据分析实战-第5章-pandas数据读写/CAPTURE_2018412_101727.jpg">
<meta property="og:image" content="http://yoursite.com/2018/04/12/python数据分析实战-第5章-pandas数据读写/CAPTURE_2018412_103216.jpg">
<meta property="og:image" content="http://yoursite.com/2018/04/12/python数据分析实战-第5章-pandas数据读写/CAPTURE_2018412_115702.jpg">
<meta property="og:updated_time" content="2018-12-02T08:41:19.327Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="python数据分析实战-第5章-pandas数据读写">
<meta name="twitter:description" content="第5章　pandas：数据读写　　915.1　I/O API 工具　　915.2　CSV和文本文件　　925.3　读取CSV或文本文件中的数据　　921from pandas import * myCSV_01.csvwhite,red,blue,green,animal1,5,2,3,cat2,7,8,5,dog3,3,6,7,horse2,2,8,3,duck4,4,2,1,mouse 12c">
<meta name="twitter:image" content="http://yoursite.com/2018/04/12/python数据分析实战-第5章-pandas数据读写/CAPTURE_2018412_101727.jpg">






  <link rel="canonical" href="http://yoursite.com/2018/04/12/python数据分析实战-第5章-pandas数据读写/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>python数据分析实战-第5章-pandas数据读写 | sun-day-blog</title>
  









  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"> 

<div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">sun-day-blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">牛逼的人生不需要解释</p>
      
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        
          
  <li class="menu-item menu-item-home">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br />首页</a>
</li>

      
        
        
          
  <li class="menu-item menu-item-tags">
    <a href="/tags/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />标签</a>
</li>

      
        
        
          
  <li class="menu-item menu-item-categories">
    <a href="/categories/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-th"></i> <br />分类</a>
</li>

      
        
        
          
  <li class="menu-item menu-item-archives">
    <a href="/archives/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />归档</a>
</li>

      
        
        
          
  <li class="menu-item menu-item-about">
    <a href="/about/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-user"></i> <br />关于</a>
</li>

      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />搜索</a>
        </li>
      
    </ul>
  

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>


  



 </div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/12/python数据分析实战-第5章-pandas数据读写/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="sun-day">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="sun-day-blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">python数据分析实战-第5章-pandas数据读写</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-04-12T09:34:12+08:00">2018-04-12</time>
            

            
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/python/" itemprop="url" rel="index"><span itemprop="name">python</span></a></span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/python/数据分析/" itemprop="url" rel="index"><span itemprop="name">数据分析</span></a></span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/python/数据分析/pandas/" itemprop="url" rel="index"><span itemprop="name">pandas</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="post-meta-item-icon"
            >
            <i class="fa fa-eye"></i>
             阅读次数： 
            <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>
            </span>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="第5章-pandas：数据读写-91"><a href="#第5章-pandas：数据读写-91" class="headerlink" title="第5章　pandas：数据读写　　91"></a>第5章　pandas：数据读写　　91</h1><h1 id="5-1-I-O-API-工具-91"><a href="#5-1-I-O-API-工具-91" class="headerlink" title="5.1　I/O API 工具　　91"></a>5.1　I/O API 工具　　91</h1><h1 id="5-2-CSV和文本文件-92"><a href="#5-2-CSV和文本文件-92" class="headerlink" title="5.2　CSV和文本文件　　92"></a>5.2　CSV和文本文件　　92</h1><h1 id="5-3-读取CSV或文本文件中的数据-92"><a href="#5-3-读取CSV或文本文件中的数据-92" class="headerlink" title="5.3　读取CSV或文本文件中的数据　　92"></a>5.3　读取CSV或文本文件中的数据　　92</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pandas <span class="keyword">import</span> *</span><br></pre></td></tr></table></figure>
<p>myCSV_01.csv<br>white,red,blue,green,animal<br>1,5,2,3,cat<br>2,7,8,5,dog<br>3,3,6,7,horse<br>2,2,8,3,duck<br>4,4,2,1,mouse</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">csvframe = read_csv(<span class="string">'myCSV_01.csv'</span>)</span><br><span class="line">print(csvframe)</span><br></pre></td></tr></table></figure>
<pre><code>   white  red  blue  green animal
0      1    5     2      3    cat
1      2    7     8      5    dog
2      3    3     6      7  horse
3      2    2     8      3   duck
4      4    4     2      1  mouse
</code></pre><p>white,red,blue,green,animal<br>1,5,2,3,cat<br>2,7,8,5,dog<br>3,3,6,7,horse<br>2,2,8,3,duck<br>4,4,2,1,mouse</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">temp = read_table(<span class="string">'ch05_01.csv'</span>,sep=<span class="string">','</span>)</span><br><span class="line">print(temp)</span><br></pre></td></tr></table></figure>
<pre><code>   white  red  blue  green animal
0      1    5     2      3    cat
1      2    7     8      5    dog
2      3    3     6      7  horse
3      2    2     8      3   duck
4      4    4     2      1  mouse
</code></pre><p>1,5,2,3,cat<br>2,7,8,5,dog<br>3,3,6,7,horse<br>2,2,8,3,duck<br>4,4,2,1,mouse</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">temp = read_csv(<span class="string">'ch05_02.csv'</span>)</span><br><span class="line">print(temp)</span><br></pre></td></tr></table></figure>
<pre><code>   1  5  2  3    cat
0  2  7  8  5    dog
1  3  3  6  7  horse
2  2  2  8  3   duck
3  4  4  2  1  mouse
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">temp = read_csv(<span class="string">'ch05_02.csv'</span>, header=<span class="keyword">None</span>)</span><br><span class="line">print(temp)</span><br></pre></td></tr></table></figure>
<pre><code>   0  1  2  3      4
0  1  5  2  3    cat
1  2  7  8  5    dog
2  3  3  6  7  horse
3  2  2  8  3   duck
4  4  4  2  1  mouse
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">temp = read_csv(<span class="string">'ch05_02.csv'</span>, names=[<span class="string">'white'</span>,<span class="string">'red'</span>,<span class="string">'blue'</span>,<span class="string">'green'</span>,<span class="string">'animal'</span>])</span><br><span class="line">print(temp)</span><br></pre></td></tr></table></figure>
<pre><code>   white  red  blue  green animal
0      1    5     2      3    cat
1      2    7     8      5    dog
2      3    3     6      7  horse
3      2    2     8      3   duck
4      4    4     2      1  mouse
</code></pre><p>color,status,item1,item2,item3<br>black,up,3,4,6<br>black,down,2,6,7<br>white,up,5,5,5<br>white,down,3,3,2<br>white,left,1,2,1<br>red,up,2,2,2<br>red,down,1,1,4</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">temp = read_csv(<span class="string">'ch05_03.csv'</span>, index_col=[<span class="string">'color'</span>,<span class="string">'status'</span>])</span><br><span class="line">print(temp)</span><br></pre></td></tr></table></figure>
<pre><code>              item1  item2  item3
color status                     
black up          3      4      6
      down        2      6      7
white up          5      5      5
      down        3      3      2
      left        1      2      1
red   up          2      2      2
      down        1      1      4
</code></pre><h2 id="5-3-1-用RegExp解析TXT文件-94"><a href="#5-3-1-用RegExp解析TXT文件-94" class="headerlink" title="5.3.1　用RegExp解析TXT文件　　94"></a>5.3.1　用RegExp解析TXT文件　　94</h2><p>white red   blue    green<br>1 5     2 3<br>2 7 8  5<br>  3  3  6   7</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">temp = read_table(<span class="string">'ch05_04.txt'</span>,sep=<span class="string">'\s+'</span>)</span><br><span class="line">print(temp)</span><br></pre></td></tr></table></figure>
<pre><code>   white  red  blue  green
0      1    5     2      3
1      2    7     8      5
2      3    3     6      7
</code></pre><p>ch05_05.txt<br>000END123AAA122<br>001END124BBB321<br>002END125CCC333</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">temp = read_table(<span class="string">'ch05_05.txt'</span>,sep=<span class="string">'\D+'</span>,header=<span class="keyword">None</span>)</span><br><span class="line">print(temp)</span><br></pre></td></tr></table></figure>
<pre><code>   0    1    2
0  0  123  122
1  1  124  321
2  2  125  333


D:\ProgramData\Anaconda3_32\lib\site-packages\ipykernel_launcher.py:1: ParserWarning: Falling back to the &#39;python&#39; engine because the &#39;c&#39; engine does not support regex separators (separators &gt; 1 char and different from &#39;\s+&#39; are interpreted as regex); you can avoid this warning by specifying engine=&#39;python&#39;.
  &quot;&quot;&quot;Entry point for launching an IPython kernel.
</code></pre><p>Table 5-1. Metacharacters<br>. single character, except newline<br>\d digit<br>\D non-digit character<br>\s whitespace character<br>\S non-whitespace character<br>\n new line character<br>\t tab character<br>\uxxxx unicode character specified by the hexadecimal number xxxxch05_06.txt</p>
<h6 id="LOG-FILE"><a href="#LOG-FILE" class="headerlink" title="##### LOG FILE"></a>##### LOG FILE</h6><p>This file has been generated by automatic system<br>white,red,blue,green,animal<br>12-Feb-2015: Counting of animals inside the house<br>1,5,2,3,cat<br>2,7,8,5,dog<br>13-Feb-2015: Counting of animals outside the house<br>3,3,6,7,horse<br>2,2,8,3,duck<br>4,4,2,1,mouse</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">temp = read_table(<span class="string">'ch05_06.txt'</span>,sep=<span class="string">','</span>,skiprows=[<span class="number">0</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">6</span>])</span><br><span class="line">print(temp)</span><br></pre></td></tr></table></figure>
<pre><code>   white  red  blue  green animal
0      1    5     2      3    cat
1      2    7     8      5    dog
2      3    3     6      7  horse
3      2    2     8      3   duck
4      4    4     2      1  mouse
</code></pre><h2 id="5-3-2-从TXT文件读取部分数据-96"><a href="#5-3-2-从TXT文件读取部分数据-96" class="headerlink" title="5.3.2　从TXT文件读取部分数据　　96"></a>5.3.2　从TXT文件读取部分数据　　96</h2><p>1,5,2,3,cat<br>2,7,8,5,dog<br>3,3,6,7,horse<br>2,2,8,3,duck<br>4,4,2,1,mouse</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">temp = read_csv(<span class="string">'ch05_02.csv'</span>,skiprows=[<span class="number">2</span>],nrows=<span class="number">3</span>,header=<span class="keyword">None</span>)</span><br><span class="line">print(temp)</span><br></pre></td></tr></table></figure>
<pre><code>   0  1  2  3     4
0  1  5  2  3   cat
1  2  7  8  5   dog
2  2  2  8  3  duck
</code></pre><p>white,red,blue,green,animal<br>1,5,2,3,cat<br>2,7,8,5,dog<br>3,3,6,7,horse<br>2,2,8,3,duck<br>4,4,2,1,mouse</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">out = Series()</span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">pieces = read_csv(<span class="string">'ch05_01.csv'</span>,chunksize=<span class="number">3</span>)</span><br><span class="line"><span class="keyword">for</span> piece <span class="keyword">in</span> pieces:</span><br><span class="line">    print(piece)</span><br><span class="line">    out.set_value(i,piece[<span class="string">'white'</span>].sum())</span><br><span class="line">    i = i + <span class="number">1</span></span><br><span class="line">print(out)</span><br></pre></td></tr></table></figure>
<pre><code>   white  red  blue  green animal
0      1    5     2      3    cat
1      2    7     8      5    dog
2      3    3     6      7  horse
   white  red  blue  green animal
3      2    2     8      3   duck
4      4    4     2      1  mouse
0    6
1    6
dtype: int64
</code></pre><h2 id="5-3-3-往CSV文件写入数据-97"><a href="#5-3-3-往CSV文件写入数据-97" class="headerlink" title="5.3.3　往CSV文件写入数据　　97"></a>5.3.3　往CSV文件写入数据　　97</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">frame2 = DataFrame(np.arange(<span class="number">16</span>).reshape((<span class="number">4</span>,<span class="number">4</span>)), columns = [<span class="string">'ball'</span>,<span class="string">'pen'</span>,<span class="string">'pencil'</span>,<span class="string">'paper'</span>])</span><br><span class="line">print(frame2)</span><br></pre></td></tr></table></figure>
<pre><code>   ball  pen  pencil  paper
0     0    1       2      3
1     4    5       6      7
2     8    9      10     11
3    12   13      14     15
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frame2.to_csv(<span class="string">'ch05_07.csv'</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frame2.to_csv(<span class="string">'ch05_07b.csv'</span>, index=<span class="keyword">False</span>, header=<span class="keyword">False</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">frame3 = read_csv(<span class="string">'ch05_08.csv'</span>)</span><br><span class="line">print(frame3)</span><br></pre></td></tr></table></figure>
<pre><code>  Unnamed: 0  ball  mug  paper   pen  pencil
0       blue   6.0  NaN    NaN   6.0     NaN
1      green   NaN  NaN    NaN   NaN     NaN
2        red   NaN  NaN    NaN   NaN     NaN
3      white  20.0  NaN    NaN  20.0     NaN
4     yellow  19.0  NaN    NaN  19.0     NaN
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frame3.to_csv(<span class="string">'ch05_08.csv'</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frame3.to_csv(<span class="string">'ch05_09.csv'</span>, na_rep =<span class="string">'NaN'</span>)</span><br></pre></td></tr></table></figure>
<p>ch05_08.csv<br>,ball,mug,paper,pen,pencil<br>blue,6.0,,,6.0,<br>green,,,,,<br>red,,,,,<br>white,20.0,,,20.0,<br>yellow,19.0,,,19.0,ch05_09.csv<br>,ball,mug,paper,pen,pencil<br>blue,6.0,NaN,NaN,6.0,NaN<br>green,NaN,NaN,NaN,NaN,NaN<br>red,NaN,NaN,NaN,NaN,NaN<br>white,20.0,NaN,NaN,20.0,NaN<br>yellow,19.0,NaN,NaN,19.0,NaN</p>
<h1 id="5-4-读写HTML文件-98"><a href="#5-4-读写HTML文件-98" class="headerlink" title="5.4　读写HTML文件　　98"></a>5.4　读写HTML文件　　98</h1><h2 id="5-4-1-写入数据到HTML文件-99"><a href="#5-4-1-写入数据到HTML文件-99" class="headerlink" title="5.4.1　写入数据到HTML文件　　99"></a>5.4.1　写入数据到HTML文件　　99</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">frame = pd.DataFrame(np.arange(<span class="number">4</span>).reshape(<span class="number">2</span>,<span class="number">2</span>))</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(frame.to_html())</span><br></pre></td></tr></table></figure>
<pre><code>&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;th&gt;1&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">frame = pd.DataFrame( np.random.random((<span class="number">4</span>,<span class="number">4</span>)),</span><br><span class="line">    index = [<span class="string">'white'</span>,<span class="string">'black'</span>,<span class="string">'red'</span>,<span class="string">'blue'</span>],</span><br><span class="line">    columns = [<span class="string">'up'</span>,<span class="string">'down'</span>,<span class="string">'right'</span>,<span class="string">'left'</span>])</span><br><span class="line">print(frame)</span><br></pre></td></tr></table></figure>
<pre><code>             up      down     right      left
white  0.821537  0.070376  0.131624  0.718632
black  0.723164  0.409424  0.554343  0.361086
red    0.671485  0.993762  0.316291  0.999724
blue   0.834104  0.565786  0.922212  0.166467
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">s = [<span class="string">'&lt;HTML&gt;'</span>]</span><br><span class="line">s.append(<span class="string">'&lt;HEAD&gt;&lt;TITLE&gt;My DataFrame&lt;/TITLE&gt;&lt;/HEAD&gt;'</span>)</span><br><span class="line">s.append(<span class="string">'&lt;BODY&gt;'</span>)</span><br><span class="line">s.append(frame.to_html())</span><br><span class="line">s.append(<span class="string">'&lt;/BODY&gt;&lt;/HTML&gt;'</span>)</span><br><span class="line">html = <span class="string">''</span>.join(s)</span><br><span class="line"></span><br><span class="line">html_file = open(<span class="string">'myFrame.html'</span>,<span class="string">'w'</span>)</span><br><span class="line">html_file.write(html)</span><br><span class="line">html_file.close()</span><br></pre></td></tr></table></figure>
<p>打开html<br><img src="/2018/04/12/python数据分析实战-第5章-pandas数据读写/CAPTURE_2018412_101727.jpg" alt="图片"></p>
<h2 id="5-4-2-从HTML文件读取数据-100"><a href="#5-4-2-从HTML文件读取数据-100" class="headerlink" title="5.4.2　从HTML文件读取数据　　100"></a>5.4.2　从HTML文件读取数据　　100</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">web_frames = pd.read_html(<span class="string">'myFrame.html'</span>)</span><br><span class="line">print(web_frames[<span class="number">0</span>])</span><br></pre></td></tr></table></figure>
<pre><code>  Unnamed: 0        up      down     right      left
0      white  0.821537  0.070376  0.131624  0.718632
1      black  0.723164  0.409424  0.554343  0.361086
2        red  0.671485  0.993762  0.316291  0.999724
3       blue  0.834104  0.565786  0.922212  0.166467
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ranking = pd.read_html(<span class="string">'http://www.meccanismocomplesso.org/en/meccanismo-complesso-sito-2/classifica-punteggio/'</span>)</span><br><span class="line">print(ranking[<span class="number">0</span>])</span><br></pre></td></tr></table></figure>
<pre><code>       #                        Nome    Exp  Livelli
0      1                 Fabio Nelli  17521      NaN
1      2                       admin   9029      NaN
2      3                 BrunoOrsini   2124      NaN
3      4                   Berserker    700      NaN
4      5                    Dnocioni    543      NaN
5      6             albertosallusti    409      NaN
6      7                         Jon    231      NaN
7      8                        Mr.Y    180      NaN
8      9             michele sisinni    157      NaN
9     10                      Selina    136      NaN
10    11                     Massimo    127      NaN
11    12             Beniamino Feula    122      NaN
12    13              stefano gustin    121      NaN
13    14           Maurizio Andreoli    111      NaN
14    15                Pietro Baima    108      NaN
15    16  Cecilia Lalatta Costerbosa    108      NaN
16    17              Leonardo Zampi    108      NaN
17    18               Davide Aloisi    106      NaN
18    19               gildalombardi    105      NaN
19    20               Telerobotlabs    104      NaN
20    21            Marco Contigiani    101      NaN
21    22                    berillio     58      NaN
22    23                         ron     55      NaN
23    24                  Titanic4wd     43      NaN
24    25                         deg     40      NaN
25    26                        al45     40      NaN
26    27                      il_mix     38      NaN
27    28                     AndreaC     35      NaN
28    29                  Sergio fly     32      NaN
29    30                     bigazzi     32      NaN
..   ...                         ...    ...      ...
220  221                        pozi      3      NaN
221  222                      mattia      3      NaN
222  223             mauro.menegazzi      3      NaN
223  224                      cico89      3      NaN
224  225                       eta38      3      NaN
225  226                Chinje Chang      3      NaN
226  227                 fraschettin      2      NaN
227  228                       Rocco      2      NaN
228  229                     Dimitri      2      NaN
229  230                      Arturo      2      NaN
230  231           Paolo Indennidate      2      NaN
231  232                fabioroberto      2      NaN
232  233                     ycomyca      2      NaN
233  234                         bdb      2      NaN
234  235             paolotirispetta      2      NaN
235  236                   Roberto72      2      NaN
236  237                 Christian76      2      NaN
237  238                    paolos46      2      NaN
238  239                    Giolat90      2      NaN
239  240                giampyypmaig      1      NaN
240  241              Marco Corbetta      1      NaN
241  242                     softeng      1      NaN
242  243                    strechum      1      NaN
243  244                      an6991      1      NaN
244  245                       plato      1      NaN
245  246              CarloAlberto98      1      NaN
246  247                        cris      1      NaN
247  248                  emilibassi      1      NaN
248  249                    mehrbano      1      NaN
249  250              NIKITA PANCHAL      1      NaN

[250 rows x 4 columns]
</code></pre><h1 id="5-5-从XML读取数据-101"><a href="#5-5-从XML读取数据-101" class="headerlink" title="5.5　从XML读取数据　　101"></a>5.5　从XML读取数据　　101</h1><p>books.xml<br>&lt;?xml version=”1.0”?&gt;</p>
<catalog>
    <book id="ISBN9872122367564">
        <author>272103_1_EnRoss, Mark</author>
        <title>XML Cookbook</title>
        <genre>Computer</genre>
        <price>23.56</price>
        <publishdate>2014-22-01</publishdate>
    </book>
    <book id="ISBN9872122367564">
        <author>272103_1_EnBracket, Barbara</author>
        <title>XML for Dummies</title>
        <genre>Computer</genre>
        <price>35.95</price>
        <publishdate>2014-12-16</publishdate>
    </book>
</catalog>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> lxml <span class="keyword">import</span> objectify</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">xml = objectify.parse(<span class="string">'books.xml'</span>)</span><br><span class="line">xml</span><br></pre></td></tr></table></figure>
<pre><code>&lt;lxml.etree._ElementTree at 0xc5d74b8&gt;
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root = xml.getroot()</span><br><span class="line">print(root.Book.Author)</span><br><span class="line">print(root.Book.PublishDate)</span><br></pre></td></tr></table></figure>
<pre><code>272103_1_EnRoss, Mark
2014-22-01
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root.getchildren()</span><br></pre></td></tr></table></figure>
<pre><code>[&lt;Element Book at 0xc761378&gt;, &lt;Element Book at 0xc761d78&gt;]
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[child.tag <span class="keyword">for</span> child <span class="keyword">in</span> root.Book.getchildren()]</span><br></pre></td></tr></table></figure>
<pre><code>[&#39;Author&#39;, &#39;Title&#39;, &#39;Genre&#39;, &#39;Price&#39;, &#39;PublishDate&#39;]
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[child.text <span class="keyword">for</span> child <span class="keyword">in</span> root.Book.getchildren()]</span><br></pre></td></tr></table></figure>
<pre><code>[&#39;272103_1_EnRoss, Mark&#39;, &#39;XML Cookbook&#39;, &#39;Computer&#39;, &#39;23.56&#39;, &#39;2014-22-01&#39;]
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">etree2df</span><span class="params">(root)</span>:</span></span><br><span class="line">    column_names = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,len(root.getchildren()[<span class="number">0</span>].getchildren())):</span><br><span class="line">        column_names.append(root.getchildren()[<span class="number">0</span>].getchildren()[i].tag)</span><br><span class="line">        </span><br><span class="line">    xml_frame = pd.DataFrame(columns=column_names)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>, len(root.getchildren())):</span><br><span class="line">        obj = root.getchildren()[j].getchildren()</span><br><span class="line">        texts = []</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> range(<span class="number">0</span>, len(column_names)):</span><br><span class="line">            texts.append(obj[k].text)</span><br><span class="line">        row = dict(zip(column_names, texts))</span><br><span class="line">        </span><br><span class="line">        row_s = pd.Series(row)</span><br><span class="line">        row_s.name = j</span><br><span class="line">        xml_frame = xml_frame.append(row_s)</span><br><span class="line">    <span class="keyword">return</span> xml_frame</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">temp = etree2df(root)</span><br><span class="line">print(temp)</span><br></pre></td></tr></table></figure>
<pre><code>                        Author            Title     Genre  Price PublishDate
0        272103_1_EnRoss, Mark     XML Cookbook  Computer  23.56  2014-22-01
1  272103_1_EnBracket, Barbara  XML for Dummies  Computer  35.95  2014-12-16
</code></pre><h1 id="5-6-读写Microsoft-Excel文件-103"><a href="#5-6-读写Microsoft-Excel文件-103" class="headerlink" title="5.6　读写Microsoft Excel文件　　103"></a>5.6　读写Microsoft Excel文件　　103</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">temp = pd.read_excel(<span class="string">'data.xls'</span>)</span><br><span class="line">print(temp)</span><br></pre></td></tr></table></figure>
<pre><code>   white  red  green  black
a     12   23     17     18
b     22   16     19     18
c     14   23     22     21
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">temp = pd.read_excel(<span class="string">'data.xls'</span>,<span class="string">'Sheet2'</span>)</span><br><span class="line">print(temp)</span><br></pre></td></tr></table></figure>
<pre><code>   yellow  purple  blue  orange
A      11      16    44      22
B      20      22    23      44
C      30      31    37      32
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">temp = pd.read_excel(<span class="string">'data.xls'</span>,<span class="number">1</span>)</span><br><span class="line">print(temp)</span><br></pre></td></tr></table></figure>
<pre><code>   yellow  purple  blue  orange
A      11      16    44      22
B      20      22    23      44
C      30      31    37      32
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">frame = pd.DataFrame(np.random.random((<span class="number">4</span>,<span class="number">4</span>)),</span><br><span class="line">    index = [<span class="string">'exp1'</span>,<span class="string">'exp2'</span>,<span class="string">'exp3'</span>,<span class="string">'exp4'</span>],</span><br><span class="line">    columns = [<span class="string">'Jan2015'</span>,<span class="string">'Fab2015'</span>,<span class="string">'Mar2015'</span>,<span class="string">'Apr2005'</span>])</span><br><span class="line">print(frame)</span><br></pre></td></tr></table></figure>
<pre><code>       Jan2015   Fab2015   Mar2015   Apr2005
exp1  0.610508  0.434578  0.019900  0.099366
exp2  0.306480  0.961355  0.073820  0.742758
exp3  0.232366  0.197025  0.312307  0.697120
exp4  0.374647  0.123761  0.521675  0.641097
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">frame.to_excel(<span class="string">'data2.xlsx'</span>)</span><br></pre></td></tr></table></figure>
<p><img src="/2018/04/12/python数据分析实战-第5章-pandas数据读写/CAPTURE_2018412_103216.jpg" alt="data2_xlsx"></p>
<h1 id="5-7-JSON数据-105"><a href="#5-7-JSON数据-105" class="headerlink" title="5.7　JSON数据　　105"></a>5.7　JSON数据　　105</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">frame = pd.DataFrame(np.arange(<span class="number">16</span>).reshape(<span class="number">4</span>,<span class="number">4</span>),</span><br><span class="line">    index=[<span class="string">'white'</span>,<span class="string">'black'</span>,<span class="string">'red'</span>,<span class="string">'blue'</span>],</span><br><span class="line">    columns=[<span class="string">'up'</span>,<span class="string">'down'</span>,<span class="string">'right'</span>,<span class="string">'left'</span>])</span><br><span class="line">print(frame)</span><br><span class="line">frame.to_json(<span class="string">'frame.json'</span>)</span><br></pre></td></tr></table></figure>
<pre><code>       up  down  right  left
white   0     1      2     3
black   4     5      6     7
red     8     9     10    11
blue   12    13     14    15
</code></pre><p>{“up”:{“white”:0,”black”:4,”red”:8,”blue”:12},”down”:{“white”:1,”black”:5,”red”:9,”blue”:13},”right”:{“white”:2,”black”:6,”red”:10,”blue”:14},”left”:{“white”:3,”black”:7,”red”:11,”blue”:15}}</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">temp = pd.read_json(<span class="string">'frame.json'</span>)</span><br><span class="line">print(temp)</span><br></pre></td></tr></table></figure>
<pre><code>       down  left  right  up
black     5     7      6   4
blue     13    15     14  12
red       9    11     10   8
white     1     3      2   0
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pandas.io.json <span class="keyword">import</span> json_normalize</span><br><span class="line">file = open(<span class="string">'books.json'</span>,<span class="string">'r'</span>)</span><br><span class="line">text = file.read()</span><br><span class="line">text = json.loads(text)</span><br><span class="line">temp = json_normalize(text,<span class="string">'books'</span>)</span><br><span class="line">print(temp)</span><br><span class="line">print()</span><br><span class="line">temp = json_normalize(text,<span class="string">'books'</span>,[<span class="string">'writer'</span>,<span class="string">'nationality'</span>])</span><br><span class="line">print(temp)</span><br></pre></td></tr></table></figure>
<pre><code>   price                title
0  23.56         XML Cookbook
1  50.70  Python Fundamentals
2  12.30    The NumPy library
3  28.60      Java Enterprise
4  31.35                HTML5
5  28.00   Python for Dummies

   price                title           writer nationality
0  23.56         XML Cookbook        Mark Ross         USA
1  50.70  Python Fundamentals        Mark Ross         USA
2  12.30    The NumPy library        Mark Ross         USA
3  28.60      Java Enterprise  Barbara Bracket          UK
4  31.35                HTML5  Barbara Bracket          UK
5  28.00   Python for Dummies  Barbara Bracket          UK


D:\ProgramData\Anaconda3_32\lib\site-packages\ipykernel_launcher.py:4: FutureWarning: pandas.json is deprecated and will be removed in a future version.
You can access loads as pandas.io.json.loads
  after removing the cwd from sys.path.
</code></pre><h1 id="5-8-HDF5格式-107"><a href="#5-8-HDF5格式-107" class="headerlink" title="5.8　HDF5格式　　107"></a>5.8　HDF5格式　　107</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pandas.io.pytables <span class="keyword">import</span> HDFStore</span><br><span class="line">frame = pd.DataFrame(np.arange(<span class="number">16</span>).reshape(<span class="number">4</span>,<span class="number">4</span>),</span><br><span class="line">    index=[<span class="string">'white'</span>,<span class="string">'black'</span>,<span class="string">'red'</span>,<span class="string">'blue'</span>],</span><br><span class="line">    columns=[<span class="string">'up'</span>,<span class="string">'down'</span>,<span class="string">'right'</span>,<span class="string">'left'</span>])</span><br><span class="line">store = HDFStore(<span class="string">'mydata.h5'</span>)</span><br><span class="line">store[<span class="string">'obj1'</span>] = frame</span><br><span class="line">store</span><br></pre></td></tr></table></figure>
<pre><code>&lt;class &#39;pandas.io.pytables.HDFStore&#39;&gt;
File path: mydata.h5
/obj1            frame        (shape-&gt;[4,4])
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">temp = store[<span class="string">'obj1'</span>]</span><br><span class="line">print(temp)</span><br></pre></td></tr></table></figure>
<pre><code>       up  down  right  left
white   0     1      2     3
black   4     5      6     7
red     8     9     10    11
blue   12    13     14    15
</code></pre><h1 id="5-9-pickle——Python对象序列化-108"><a href="#5-9-pickle——Python对象序列化-108" class="headerlink" title="5.9　pickle——Python对象序列化　　108"></a>5.9　pickle——Python对象序列化　　108</h1><h2 id="5-9-1-用pickle实现Python对象序列化-109"><a href="#5-9-1-用pickle实现Python对象序列化-109" class="headerlink" title="5.9.1　用pickle实现Python对象序列化　　109"></a>5.9.1　用pickle实现Python对象序列化　　109</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle <span class="keyword">as</span> pickle</span><br><span class="line">data = &#123; <span class="string">'color'</span>: [<span class="string">'white'</span>,<span class="string">'red'</span>], <span class="string">'value'</span>: [<span class="number">5</span>, <span class="number">7</span>]&#125;</span><br><span class="line">pickled_data = pickle.dumps(data)</span><br><span class="line">print(pickled_data)</span><br></pre></td></tr></table></figure>
<pre><code>b&#39;\x80\x03}q\x00(X\x05\x00\x00\x00colorq\x01]q\x02(X\x05\x00\x00\x00whiteq\x03X\x03\x00\x00\x00redq\x04eX\x05\x00\x00\x00valueq\x05]q\x06(K\x05K\x07eu.&#39;
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nframe = pickle.loads(pickled_data)</span><br><span class="line">nframe</span><br></pre></td></tr></table></figure>
<pre><code>{&#39;color&#39;: [&#39;white&#39;, &#39;red&#39;], &#39;value&#39;: [5, 7]}
</code></pre><h2 id="5-9-2-用pandas实现对象序列化-109"><a href="#5-9-2-用pandas实现对象序列化-109" class="headerlink" title="5.9.2　用pandas实现对象序列化　　109"></a>5.9.2　用pandas实现对象序列化　　109</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">frame = pd.DataFrame(np.arange(<span class="number">16</span>).reshape(<span class="number">4</span>,<span class="number">4</span>), index = [<span class="string">'up'</span>,<span class="string">'down'</span>,<span class="string">'left'</span>,<span class="string">'right'</span>])</span><br><span class="line">frame.to_pickle(<span class="string">'frame.pkl'</span>)</span><br><span class="line"></span><br><span class="line">temp = pd.read_pickle(<span class="string">'frame.pkl'</span>)</span><br><span class="line">print(temp)</span><br></pre></td></tr></table></figure>
<pre><code>        0   1   2   3
up      0   1   2   3
down    4   5   6   7
left    8   9  10  11
right  12  13  14  15
</code></pre><h1 id="5-10-对接数据库-110"><a href="#5-10-对接数据库-110" class="headerlink" title="5.10　对接数据库　　110"></a>5.10　对接数据库　　110</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sqlalchemy <span class="keyword">import</span> create_engine</span><br><span class="line"><span class="comment">#For PostgreSQL</span></span><br><span class="line">engine = create_engine(<span class="string">'postgresql://scott:tiger@localhost:5432/mydatabase'</span>)</span><br><span class="line"><span class="comment">#For MySQL</span></span><br><span class="line">engine = create_engine(<span class="string">'mysql+mysqldb://scott:tiger@localhost/foo'</span>)</span><br><span class="line"><span class="comment">#For Oracle</span></span><br><span class="line">engine = create_engine(<span class="string">'oracle://scott:tiger@127.0.0.1:1521/sidname'</span>)</span><br><span class="line"><span class="comment">#For MSSQL</span></span><br><span class="line">engine = create_engine(<span class="string">'mssql+pyodbc://mydsn'</span>)</span><br><span class="line"><span class="comment">#For SQLite</span></span><br><span class="line">engine = create_engine(<span class="string">'sqlite:///foo.db'</span>)</span><br></pre></td></tr></table></figure>
<p>上面代码运行可能会出现错误，根据运行结果，缺少什么使用pip安装什么就可以了。</p>
<h2 id="5-10-1-SQLite3数据读写-111"><a href="#5-10-1-SQLite3数据读写-111" class="headerlink" title="5.10.1　SQLite3数据读写　　111"></a>5.10.1　SQLite3数据读写　　111</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">frame = pd.DataFrame( np.arange(<span class="number">20</span>).reshape(<span class="number">4</span>,<span class="number">5</span>),</span><br><span class="line">    columns=[<span class="string">'white'</span>,<span class="string">'red'</span>,<span class="string">'blue'</span>,<span class="string">'black'</span>,<span class="string">'green'</span>])</span><br><span class="line">print(frame)</span><br></pre></td></tr></table></figure>
<pre><code>   white  red  blue  black  green
0      0    1     2      3      4
1      5    6     7      8      9
2     10   11    12     13     14
3     15   16    17     18     19
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">engine = create_engine(<span class="string">'sqlite:///foo.db'</span>)</span><br><span class="line">frame.to_sql(<span class="string">'colors'</span>,engine)</span><br><span class="line"></span><br><span class="line">temp = pd.read_sql(<span class="string">'colors'</span>,engine)</span><br><span class="line">print(temp)</span><br></pre></td></tr></table></figure>
<pre><code>   index  white  red  blue  black  green
0      0      0    1     2      3      4
1      1      5    6     7      8      9
2      2     10   11    12     13     14
3      3     15   16    17     18     19
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sqlite3</span><br><span class="line">query = <span class="string">"""</span></span><br><span class="line"><span class="string">CREATE TABLE test</span></span><br><span class="line"><span class="string">(a VARCHAR(20), b VARCHAR(20),</span></span><br><span class="line"><span class="string">c REAL, d INTEGER</span></span><br><span class="line"><span class="string">);"""</span></span><br><span class="line">con = sqlite3.connect(<span class="string">':memory:'</span>)</span><br><span class="line">con.execute(query)</span><br><span class="line">con.commit()</span><br><span class="line"></span><br><span class="line">data = [(<span class="string">'white'</span>,<span class="string">'up'</span>,<span class="number">1</span>,<span class="number">3</span>),</span><br><span class="line">        (<span class="string">'black'</span>,<span class="string">'down'</span>,<span class="number">2</span>,<span class="number">8</span>),</span><br><span class="line">        (<span class="string">'green'</span>,<span class="string">'up'</span>,<span class="number">4</span>,<span class="number">4</span>),</span><br><span class="line">        (<span class="string">'red'</span>,<span class="string">'down'</span>,<span class="number">5</span>,<span class="number">5</span>)]</span><br><span class="line">stmt = <span class="string">"INSERT INTO test VALUES(?,?,?,?)"</span></span><br><span class="line">con.executemany(stmt, data)</span><br><span class="line">con.commit()</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cursor = con.execute(<span class="string">'select * from test'</span>)</span><br><span class="line">print(cursor)</span><br><span class="line">rows = cursor.fetchall()</span><br><span class="line">rows</span><br></pre></td></tr></table></figure>
<pre><code>&lt;sqlite3.Cursor object at 0x0D591820&gt;





[(&#39;white&#39;, &#39;up&#39;, 1.0, 3),
 (&#39;black&#39;, &#39;down&#39;, 2.0, 8),
 (&#39;green&#39;, &#39;up&#39;, 4.0, 4),
 (&#39;red&#39;, &#39;down&#39;, 5.0, 5)]
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cursor.description</span><br></pre></td></tr></table></figure>
<pre><code>((&#39;a&#39;, None, None, None, None, None, None),
 (&#39;b&#39;, None, None, None, None, None, None),
 (&#39;c&#39;, None, None, None, None, None, None),
 (&#39;d&#39;, None, None, None, None, None, None))
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">temp = pd.DataFrame(rows, columns=[<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>])</span><br><span class="line">print(temp)</span><br></pre></td></tr></table></figure>
<pre><code>       a     b    c  d
0  white    up  1.0  3
1  black  down  2.0  8
2  green    up  4.0  4
3    red  down  5.0  5
</code></pre><h2 id="5-10-2-PostgreSQL数据读写-112"><a href="#5-10-2-PostgreSQL数据读写-112" class="headerlink" title="5.10.2　PostgreSQL数据读写　　112"></a>5.10.2　PostgreSQL数据读写　　112</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">engine = create_engine(<span class="string">'postgresql://scott:tiger@localhost:5432/mydatabase'</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">frame = pd.DataFrame(np.random.random((<span class="number">4</span>,<span class="number">4</span>)),</span><br><span class="line">    index=[<span class="string">'exp1'</span>,<span class="string">'exp2'</span>,<span class="string">'exp3'</span>,<span class="string">'exp4'</span>],</span><br><span class="line">    columns=[<span class="string">'feb'</span>,<span class="string">'mar'</span>,<span class="string">'apr'</span>,<span class="string">'may'</span>]);</span><br><span class="line">frame.to_sql(<span class="string">'dataframe'</span>,engine)</span><br></pre></td></tr></table></figure>
<p>postgres=# SELECT * FROM DATAFRAME;</p>
<p><img src="/2018/04/12/python数据分析实战-第5章-pandas数据读写/CAPTURE_2018412_115702.jpg" alt="数据"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">temp = pd.read_sql_table(<span class="string">'dataframe'</span>,engine)</span><br><span class="line">print(temp)</span><br></pre></td></tr></table></figure>
<pre><code>  index       feb       mar       apr       may
0  exp1  0.406820  0.964683  0.181662  0.660217
1  exp2  0.573869  0.940819  0.426104  0.484574
2  exp3  0.649881  0.059990  0.616504  0.681356
3  exp4  0.061554  0.733131  0.998748  0.127283
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">temp = pd.read_sql_query(<span class="string">'SELECT index,apr,may FROM DATAFRAME WHERE apr &gt; 0.5'</span>,engine)</span><br><span class="line">print(temp)</span><br></pre></td></tr></table></figure>
<pre><code>  index       apr       may
0  exp3  0.616504  0.681356
1  exp4  0.998748  0.127283
</code></pre><h1 id="5-11-NoSQL数据库MongoDB数据读写-114"><a href="#5-11-NoSQL数据库MongoDB数据读写-114" class="headerlink" title="5.11　NoSQL数据库MongoDB数据读写　　114"></a>5.11　NoSQL数据库MongoDB数据读写　　114</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pymongo</span><br><span class="line">client = pymongo.MongoClient(<span class="string">'localhost'</span>,<span class="number">27017</span>)</span><br><span class="line">db = client.mydatabase</span><br><span class="line">db</span><br></pre></td></tr></table></figure>
<pre><code>Database(MongoClient(host=[&#39;localhost:27017&#39;], document_class=dict, tz_aware=False, connect=True), &#39;mydatabase&#39;)
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">client[<span class="string">'mydatabase'</span>]</span><br></pre></td></tr></table></figure>
<pre><code>Database(MongoClient(host=[&#39;localhost:27017&#39;], document_class=dict, tz_aware=False, connect=True), &#39;mydatabase&#39;)
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">collection = db.mycollection</span><br><span class="line">db[<span class="string">'mycollection'</span>]</span><br></pre></td></tr></table></figure>
<pre><code>Collection(Database(MongoClient(host=[&#39;localhost:27017&#39;], document_class=dict, tz_aware=False, connect=True), &#39;mydatabase&#39;), &#39;mycollection&#39;)
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">collection</span><br></pre></td></tr></table></figure>
<pre><code>Collection(Database(MongoClient(host=[&#39;localhost:27017&#39;], document_class=dict, tz_aware=False, connect=True), &#39;mydatabase&#39;), &#39;mycollection&#39;)
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">frame = pd.DataFrame( np.arange(<span class="number">20</span>).reshape(<span class="number">4</span>,<span class="number">5</span>),</span><br><span class="line">    columns=[<span class="string">'white'</span>,<span class="string">'red'</span>,<span class="string">'blue'</span>,<span class="string">'black'</span>,<span class="string">'green'</span>])</span><br><span class="line">print(frame)</span><br></pre></td></tr></table></figure>
<pre><code>   white  red  blue  black  green
0      0    1     2      3      4
1      5    6     7      8      9
2     10   11    12     13     14
3     15   16    17     18     19
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line">record = json.loads(frame.T.to_json()).values()</span><br><span class="line">record</span><br></pre></td></tr></table></figure>
<pre><code>dict_values([{&#39;white&#39;: 0, &#39;red&#39;: 1, &#39;blue&#39;: 2, &#39;black&#39;: 3, &#39;green&#39;: 4}, {&#39;white&#39;: 5, &#39;red&#39;: 6, &#39;blue&#39;: 7, &#39;black&#39;: 8, &#39;green&#39;: 9}, {&#39;white&#39;: 10, &#39;red&#39;: 11, &#39;blue&#39;: 12, &#39;black&#39;: 13, &#39;green&#39;: 14}, {&#39;white&#39;: 15, &#39;red&#39;: 16, &#39;blue&#39;: 17, &#39;black&#39;: 18, &#39;green&#39;: 19}])
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">collection.mydocument.insert(record)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cursor = collection[<span class="string">'mydocument'</span>].find()</span><br><span class="line">print(type(cursor))</span><br><span class="line">dataframe = (list(cursor))</span><br><span class="line">data = pd.DataFrame(dataframe)</span><br><span class="line"><span class="keyword">del</span> data[<span class="string">'_id'</span>]</span><br><span class="line">print(data)</span><br></pre></td></tr></table></figure>
<pre><code>&lt;class &#39;pymongo.cursor.Cursor&#39;&gt;
   black  blue  green  red  white
0      3     2      4    1      0
1      8     7      9    6      5
2     13    12     14   11     10
3     18    17     19   16     15
</code></pre><h1 id="5-12-小结-116"><a href="#5-12-小结-116" class="headerlink" title="5.12　小结　　116"></a>5.12　小结　　116</h1>
      
    </div>

    

    
    
    

    <div>
      
        <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div>
    
</div>

      
    </div>

    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div></div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>打赏</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/images/wechatpay.png" alt="sun-day 微信支付"/>
        <p>微信支付</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/images/alipay.jpg" alt="sun-day 支付宝"/>
        <p>支付宝</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/python/" rel="tag"><i class="fa fa-tag"></i> python</a>
          
            <a href="/tags/pandas/" rel="tag"><i class="fa fa-tag"></i> pandas</a>
          
            <a href="/tags/数据分析/" rel="tag"><i class="fa fa-tag"></i> 数据分析</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/04/11/linux防火墙设置/" rel="next" title="linux防火墙设置">
                <i class="fa fa-chevron-left"></i> linux防火墙设置
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/04/12/python-mysql-python2和3的差异/" rel="prev" title="python-mysql-python2和3的差异">
                python-mysql-python2和3的差异 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
        <!-- JiaThis Button BEGIN -->
<div class="jiathis_style">
<span class="jiathis_txt">分享到：</span>
<a class="jiathis_button_fav">收藏夹</a>
<a class="jiathis_button_copy">复制网址</a>
<a class="jiathis_button_email">邮件</a>
<a class="jiathis_button_weixin">微信</a>
<a class="jiathis_button_qzone">QQ空间</a>
<a class="jiathis_button_tqq">腾讯微博</a>
<a class="jiathis_button_douban">豆瓣</a>
<a class="jiathis_button_share">一键分享</a>

<a href="http://www.jiathis.com/share?uid=2140465" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank">更多</a>
<a class="jiathis_counter_style"></a>
</div>
<script type="text/javascript" >
var jiathis_config={
  data_track_clickback:true,
  summary:"",
  shortUrl:false,
  hideMore:false
}
</script>
<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=2160523" charset="utf-8"></script>
<!-- JiaThis Button END -->
      
    </div>
  </div>


          </div>
          

  
    <div class="comments" id="comments">
      <div id="lv-container" data-id="city" data-uid="MTAyMC8zNTY1MC8xMjE4Ng=="></div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.jpg"
                alt="sun-day" />
            
              <p class="site-author-name" itemprop="name">sun-day</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">193</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">33</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">88</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  <a href="https://github.com/zhanghaogithub123" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i>GitHub</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="mailto:zhanghao163mail@163.com" target="_blank" title="E-Mail"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="https://blog.csdn.net/mouse1598189" target="_blank" title="CSDN"><i class="fa fa-fw fa-globe"></i>CSDN</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="https://www.zhihu.com/people/zhang-hao-3-80-49/activities" target="_blank" title="知乎"><i class="fa fa-fw fa-globe"></i>知乎</a>
                  
                </span>
              
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.google.com/" title="Google" target="_blank">Google</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.baidu.com/" title="百度" target="_blank">百度</a>
                  </li>
                
              </ul>
            </div>
          

          
            
          
          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#第5章-pandas：数据读写-91"><span class="nav-number">1.</span> <span class="nav-text">第5章　pandas：数据读写　　91</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#5-1-I-O-API-工具-91"><span class="nav-number">2.</span> <span class="nav-text">5.1　I/O API 工具　　91</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#5-2-CSV和文本文件-92"><span class="nav-number">3.</span> <span class="nav-text">5.2　CSV和文本文件　　92</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#5-3-读取CSV或文本文件中的数据-92"><span class="nav-number">4.</span> <span class="nav-text">5.3　读取CSV或文本文件中的数据　　92</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#5-3-1-用RegExp解析TXT文件-94"><span class="nav-number">4.1.</span> <span class="nav-text">5.3.1　用RegExp解析TXT文件　　94</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#LOG-FILE"><span class="nav-number">4.1.0.0.0.1.</span> <span class="nav-text">##### LOG FILE</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-3-2-从TXT文件读取部分数据-96"><span class="nav-number">4.2.</span> <span class="nav-text">5.3.2　从TXT文件读取部分数据　　96</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-3-3-往CSV文件写入数据-97"><span class="nav-number">4.3.</span> <span class="nav-text">5.3.3　往CSV文件写入数据　　97</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#5-4-读写HTML文件-98"><span class="nav-number">5.</span> <span class="nav-text">5.4　读写HTML文件　　98</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#5-4-1-写入数据到HTML文件-99"><span class="nav-number">5.1.</span> <span class="nav-text">5.4.1　写入数据到HTML文件　　99</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-4-2-从HTML文件读取数据-100"><span class="nav-number">5.2.</span> <span class="nav-text">5.4.2　从HTML文件读取数据　　100</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#5-5-从XML读取数据-101"><span class="nav-number">6.</span> <span class="nav-text">5.5　从XML读取数据　　101</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#5-6-读写Microsoft-Excel文件-103"><span class="nav-number">7.</span> <span class="nav-text">5.6　读写Microsoft Excel文件　　103</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#5-7-JSON数据-105"><span class="nav-number">8.</span> <span class="nav-text">5.7　JSON数据　　105</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#5-8-HDF5格式-107"><span class="nav-number">9.</span> <span class="nav-text">5.8　HDF5格式　　107</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#5-9-pickle——Python对象序列化-108"><span class="nav-number">10.</span> <span class="nav-text">5.9　pickle——Python对象序列化　　108</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#5-9-1-用pickle实现Python对象序列化-109"><span class="nav-number">10.1.</span> <span class="nav-text">5.9.1　用pickle实现Python对象序列化　　109</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-9-2-用pandas实现对象序列化-109"><span class="nav-number">10.2.</span> <span class="nav-text">5.9.2　用pandas实现对象序列化　　109</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#5-10-对接数据库-110"><span class="nav-number">11.</span> <span class="nav-text">5.10　对接数据库　　110</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#5-10-1-SQLite3数据读写-111"><span class="nav-number">11.1.</span> <span class="nav-text">5.10.1　SQLite3数据读写　　111</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-10-2-PostgreSQL数据读写-112"><span class="nav-number">11.2.</span> <span class="nav-text">5.10.2　PostgreSQL数据读写　　112</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#5-11-NoSQL数据库MongoDB数据读写-114"><span class="nav-number">12.</span> <span class="nav-text">5.11　NoSQL数据库MongoDB数据读写　　114</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#5-12-小结-116"><span class="nav-number">13.</span> <span class="nav-text">5.12　小结　　116</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<div class="copyright">&copy; 2015 &mdash; <span itemprop="copyrightYear">2018</span>
  <span class="with-love" id="animate"> 
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">true</span>

  

  
</div>





  <div class="powered-by">
  <i class="fa fa-user-md"></i><span id="busuanzi_container_site_pv">
    本站访客数:<span id="busuanzi_container_site_pv"></span>
  </span>
  </div>
  
  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/theme-next/hexo-theme-next">NexT.Gemini</a> v6.1.0</div>




<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">博客全站共345.4k字</span>
</div>

        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv" title="总访客量">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
    </span>
  

  
    <span class="site-pv" title="总访问量">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
    </span>
  
</div>









        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=6.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=6.1.0"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=6.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=6.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.1.0"></script>



  



	





  





  
    <script type="text/javascript">
      (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
      })(document, 'script');
    </script>
  










  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  
  

  
    
      <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>
<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script>

    
  


  
  

  

  

  

  

</body>
</html>
